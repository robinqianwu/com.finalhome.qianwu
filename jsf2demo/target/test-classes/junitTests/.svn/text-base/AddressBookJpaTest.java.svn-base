package junitTests;

import java.util.List;

import junit.framework.TestCase;

import org.junit.Before;
import org.junit.Test;

import de.jsf.jpa.JpaAddressBook;
import de.jsf.jpaImpl.AddressBook;
import de.jsf.model.Person;

public class AddressBookJpaTest extends TestCase
{

    private AddressBook adressBook;

    @Override
    @Before
    public void setUp()
    {
        adressBook = new JpaAddressBook();
    }

    @Test
    public void testAddPerson() throws Exception
    {

        Person p = new Person();
        p.setFirstName("Example Name");
        assertNull("Id bereits vor persist() gesetzt", p.getId());

        //insert
        adressBook.addPerson(p);
        assertNotNull("Id nach persist() noch nicht gesetzt", p.getId());
    }

    @Test
    public void testAddAndGet() throws Exception
    {
        Person p = new Person();
        p.setFirstName("Hilde");
        p.setLastName("Hirsch");
        assertNull("Id bereits vor persist() gesetzt", p.getId());

        //insert
        //adressBook.addPerson(p);
        //assertNotNull("Id nach persist() noch nicht gesetzt", p.getId());

        //select
        List<Person> persons = adressBook.getPersons();

        System.out.println("Gefundene Personen: " + persons);
        assertTrue("Keine Person gefunden", persons.size() > 0);

        Person lastPerson = persons.get(persons.size() - 1);
        assertNotNull(lastPerson.getId());
        assertEquals("Hilde", lastPerson.getFirstName());
        assertEquals("Hirsch", lastPerson.getLastName());
    }
}
